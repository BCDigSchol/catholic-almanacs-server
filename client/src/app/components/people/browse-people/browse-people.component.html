<div *ngIf="!loading">

    <div class="flex flex-row justify-start items-center">
        <mat-card class="w-full">
            <mat-card-content>
                <div class="flex flex-col justify-start w-full">
                    <div class="flex flex-wrap md:flex-nowrap justify-start items-center">
                        <mat-form-field class="mx-2 w-full sm:w-auto">
                            <mat-label>Filter by Person Name</mat-label>
                            <input matInput [(ngModel)]="filterBy.name" (input)="getData()">
                        </mat-form-field>
                        <mat-form-field class="mx-2 w-full sm:w-auto">
                            <mat-label>Filter by City</mat-label>
                            <input matInput [(ngModel)]="filterBy.cityReg" (input)="getData()">
                        </mat-form-field>
                        <mat-form-field class="mx-2 w-full sm:w-auto">
                            <mat-label>Filter by Diocese</mat-label>
                            <input matInput [(ngModel)]="filterBy.diocese" (input)="getData()">
                        </mat-form-field>
                        <mat-form-field class="mx-2 w-full sm:w-auto">
                            <mat-label>Filter by Inst Name</mat-label>
                            <input matInput [(ngModel)]="filterBy.instName" (input)="getData()">
                        </mat-form-field>
                    </div>
                    <div class="flex justify-between max-w-[250px]">
                        <label id="example-name-label" class="example-name-label">Year</label>
                        <label class="example-value-label">{{filterBy.year || 'All Years'}}</label>
                    </div>
                    <div class="flex flex-row justify-start items-center">
                        <mat-slider class="mx-2" style="width:230px" min="1864" max="1870" step="1" [discrete]="true">
                            <input matSliderThumb [(ngModel)]="filterBy.year" (input)="getData()">
                        </mat-slider>
                        <div>
                            <button mat-button class="mx-2" (click)="resetYear()" color="primary">Reset Year</button>
                        </div>
                    </div>
                    <div>
                        <mat-paginator (page)="changePage($event)"
                        [length]="totalItems"
                        [pageSize]="itemsPerPage"
                        [pageIndex]="currentPage"
                        [showFirstLastButtons]="true"
                        [pageSizeOptions]="[5, 10, 25, 50]">
                        </mat-paginator>
                    </div>
                </div>
            </mat-card-content>
        </mat-card>
    </div>

    <mat-card *ngFor="let item of data" class="my-5">
        <mat-card-header [routerLink]="'/people/' + item.ID" style="cursor: pointer;">
            <mat-card-title>
                {{ item.almanacRecords[item.almanacRecords.length - 1].personInAlmanacRecord.title + ' ' + item.almanacRecords[item.almanacRecords.length - 1]?.personInAlmanacRecord.name }}
            </mat-card-title>
        </mat-card-header>
        <mat-card-content>
            <mat-list>
                <mat-list-item>
                    <mat-icon matListItemIcon>description</mat-icon>
                    <div matListItemTitle>
                        ID: {{ item.ID }}
                    </div>
                    <div matListItemLine>
                        Years In Records:
                        <span *ngFor="let year of getUniqueYears(item.almanacRecords)">
                            {{ year }} 
                        </span>
                    </div>
                    <div matListItemLine>
                        Diocese (in {{item.almanacRecords[item.almanacRecords.length - 1].year}}):
                        {{ item.almanacRecords[item.almanacRecords.length - 1].diocese }}
                    </div>
                </mat-list-item>
            </mat-list>
        </mat-card-content>
    </mat-card>
</div>