<!-- Wide Display -->
<div class="wide-display">
<mat-accordion style="width:260px">
    <mat-expansion-panel [expanded]="isOpen" style="width:100%"> 
        <mat-expansion-panel-header>
            <div>
                <mat-panel-title style="color:#101b32" class="custom-font-filter">
                Filter by:
                </mat-panel-title>
            </div>
        </mat-expansion-panel-header>
        <mat-chip-listbox style="display: flex; flex-direction: column; width: 100%; align-items: stretch;">
            <ng-container *ngFor="let filter of filterService.fields; let index = index">
            @if (!filter.active){
            <mat-chip (click)="toggleFilter(index)"
                style="width: 100%; max-width: 200px; height: 37px; display: flex; align-items: center; justify-content: center; margin: 2 auto; font-family:'Open Sans', sans-serif;">
                 +
                {{ filter.label }}
            </mat-chip>
            } @else {
                <div style="display: flex; align-items: center; justify-content: center; width: 100%;">
                <ng-container [ngSwitch]="true">
                    <div *ngSwitchCase="filter.type == 'input'">
                        <div class="ml-2">
                        <mat-form-field appearance="fill" class="filter-form-field" subscriptSizing="dynamic">
                            <mat-label style="font-size:14px;">{{filter.label}}</mat-label>
                            <input matInput
                            (input)="updateFilter(filter)"
                            [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-icon matSuffix style="cursor: pointer; font-size:16px; display:flex; align-items: center; justify-content: center;" (click)="toggleFilter(index)">close</mat-icon>
                        </mat-form-field>
                        </div>
                    </div>
                    <div *ngSwitchCase="filter.type == 'range'">
                        <div class="mt-3 ml-20" style="color:#101b32; font-size:14px">Year</div>
                        <mat-slider class="mx-2" style="width:140px" [min]="filter.min" [max]="filter.max" step="1" discrete>
                            <input value="{{filter.min}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keywordStart!]" matSliderStartThumb >
                            <input value="{{filter.max}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keywordEnd!]" matSliderEndThumb >
                        </mat-slider>
                        <div style="color:#101b32; font-size:14px">{{filterValues[filter.keywordStart!]}} - {{filterValues[filter.keywordEnd!]}}</div>
                    </div>
                    <div *ngSwitchCase="filter.type == 'slider'">
                        <mat-slider class="mx-2" style="width:140px" [min]="filter.min" [max]="filter.max" step="1" discrete>
                            <input value="{{filter.min}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]" matSliderThumb >
                        </mat-slider>
                    </div>
                    <div *ngSwitchCase="filter.type == 'boolean'">
                      <mat-slide-toggle id="{{ filter.keyword }} + 'Filter'" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]">
                        {{ filter.label }}
                      </mat-slide-toggle>
                    </div>
                    <div *ngSwitchCase="filter.type == 'dropdown'">
                        <mat-form-field class="ml-2">
                            <mat-select placeholder="{{filter.label}}" class="border border-gray-300 rounded-lg" id="{{ filter.keyword }} + 'Filter'" (selectionChange)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-option *ngFor="let option of filter.dropdown" [value]="option">{{ option }}</mat-option>
                            </mat-select>
                            <button mat-icon-button  matSuffix color="warn" type="button" class="custom-button" (click)="toggleFilter(index)">
                                <mat-icon fontIcon="close"></mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div *ngSwitchCase="filter.type == 'autocomplete'">
                        <mat-form-field class="filter-form-field ml-2" subscriptSizing="dynamic">
                            <mat-label style="font-size: 14px">{{filter.label}}</mat-label>
                            <input matInput [matAutocomplete]="auto" (input)="onAutocompleteInput($event, filter)" [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="updateFilter(filter)">
                                <mat-option *ngFor="let option of filter.filteredOptions" [value]="option">{{ option }}</mat-option>
                            </mat-autocomplete>
                            <mat-icon matSuffix style="cursor: pointer; font-size:16px; display:flex; align-items: center; justify-content: center;" (click)="toggleFilter(index)">close</mat-icon>
                        </mat-form-field>
                    </div>
                </ng-container>
                </div>}
                </ng-container>
        </mat-chip-listbox>
    </mat-expansion-panel>
</mat-accordion>
</div>

<!-- Mobile Display -->
<div class="mobile-display">
<mat-accordion style="width:100%">
    <mat-expansion-panel [expanded]="isOpen" style="width:100%;"> 
        <mat-expansion-panel-header>
            <div>
                <mat-panel-title style="color:#101b32" class="custom-font-filter">
                Filter by:
                </mat-panel-title>
            </div>
        </mat-expansion-panel-header>
        <mat-chip-listbox style="display: flex; flex-direction: row; flex-wrap: wrap; width: 100%; align-items: stretch; gap: 8px;">
            <ng-container *ngFor="let filter of filterService.fields; let index = index">
            @if (!filter.active){
            <mat-chip (click)="toggleFilter(index)"
                style="max-width: 150px; height: 37px; display: flex; align-items: center; justify-content: center; font-family:'Open Sans', sans-serif;">
                 +
                {{ filter.label }}
            </mat-chip>
            } @else {
                <div style="display: flex; align-items: center; justify-content: center;" class="mx-1">
                <ng-container [ngSwitch]="true">
                    <div *ngSwitchCase="filter.type == 'input'">
                        <mat-form-field appearance="fill" class="filter-form-field" style="width:150px" subscriptSizing="dynamic">
                            <mat-label style="font-size:11.5px;">{{filter.label}}</mat-label>
                            <input matInput
                            (input)="updateFilter(filter)"
                            [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-icon matSuffix style="cursor: pointer; font-size:16px; display:flex; align-items: center; justify-content: center;" (click)="toggleFilter(index)">close</mat-icon>
                        </mat-form-field>
                    </div>
                    <div *ngSwitchCase="filter.type == 'range'">
                        <div class="mt-3" style="color:#101b32; font-size:14px; width:160px">Year</div>
                        <mat-slider class="mx-2" [min]="filter.min" [max]="filter.max" step="1" discrete>
                            <input value="{{filter.min}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keywordStart!]" matSliderStartThumb >
                            <input value="{{filter.max}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keywordEnd!]" matSliderEndThumb >
                        </mat-slider>
                        <div style="color:#101b32; font-size:14px">{{filterValues[filter.keywordStart!]}} - {{filterValues[filter.keywordEnd!]}}</div>
                    </div>
                    <div *ngSwitchCase="filter.type == 'slider'">
                        <mat-slider class="mx-2" [min]="filter.min" [max]="filter.max" step="1" discrete>
                            <input value="{{filter.min}}" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]" matSliderThumb >
                        </mat-slider>
                    </div>
                    <div *ngSwitchCase="filter.type == 'boolean'">
                      <mat-slide-toggle id="{{ filter.keyword }} + 'Filter'" (change)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]">
                        {{ filter.label }}
                      </mat-slide-toggle>
                    </div>
                    <div *ngSwitchCase="filter.type == 'dropdown'">
                        <mat-form-field style="width:140px">
                            <mat-select placeholder="{{filter.label}}" class="border border-gray-300 rounded-lg" id="{{ filter.keyword }} + 'Filter'" (selectionChange)="updateFilter(filter)" [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-option *ngFor="let option of filter.dropdown" [value]="option">{{ option }}</mat-option>
                            </mat-select>
                            <button mat-icon-button  matSuffix color="warn" type="button" class="custom-button" (click)="toggleFilter(index)">
                                <mat-icon fontIcon="close"></mat-icon>
                            </button>
                        </mat-form-field>
                    </div>
                    <div *ngSwitchCase="filter.type == 'autocomplete'">
                        <mat-form-field class="filter-form-field" subscriptSizing="dynamic" style="width:150px">
                            <mat-label style="font-size: 11.5px">{{filter.label}}</mat-label>
                            <input matInput [matAutocomplete]="auto" (input)="onAutocompleteInput($event, filter)" [(ngModel)]="filterValues[filter.keyword!]">
                            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="updateFilter(filter)">
                                <mat-option *ngFor="let option of filter.filteredOptions" [value]="option">{{ option }}</mat-option>
                            </mat-autocomplete>
                            <mat-icon matSuffix style="cursor: pointer; font-size:16px; display:flex; align-items: center; justify-content: center;" (click)="toggleFilter(index)">close</mat-icon>
                        </mat-form-field>
                    </div>
                </ng-container>
                </div>}
                </ng-container>
        </mat-chip-listbox>
    </mat-expansion-panel>
</mat-accordion>
</div>